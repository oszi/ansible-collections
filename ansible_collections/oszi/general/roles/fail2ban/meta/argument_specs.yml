---
argument_specs:
  main:
    short_description: Fail2ban intrusion prevention configuration
    description:
      - Configures Fail2ban to protect SSH server and other services from brute force attacks
      - Manages jail and filter configurations
    author:
      - "David O. (oszi.dev)"
    options:
      fail2ban_disabled:
        description:
          - Whether to disable fail2ban service and configuration
          - Disabled by default when SSH server is disabled or on RHEL (non-Fedora)
        type: bool
        required: false

      fail2ban_local:
        description:
          - Content for fail2ban.local configuration file
          - Contains global Fail2ban settings including log target
        type: str
        required: false

      fail2ban_jail_local:
        description:
          - Content for jail.local configuration file
          - Configures jails for different services including ban times and thresholds
          - Default enables sshd jail with 24h ban time
        type: str
        required: false

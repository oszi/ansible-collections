---
argument_specs:
  main:
    short_description: Libvirt virtualization platform management for workstations
    description:
      - Installs virtualization packages including virt-manager and guestfs-tools
      - Configures virtual machines, networks, and storage pools (use with caution)
      - Provides utility scripts for VM management
    author:
      - "David O. (oszi.dev)"
    options:
      libvirt_disabled:
        description:
          - Whether to skip libvirt installation and configuration
          - Disabled by default when the host is a virtualization guest
          - Set to false to enable nested virtualization
        type: bool
        required: false

      libvirt_local_bin_path:
        description:
          - Directory path where libvirt utility scripts are installed
          - Defaults to `local_bin_path` if set (should be in system PATH)
        type: path
        required: false

      libvirt_packages:
        description:
          - Nested list of libvirt/QEMU packages and tools to install
          - Includes GUI tools (virt-manager), guestfs utilities, and architecture support
        type: list
        elements: raw
        required: false

      libvirt_domains:
        description:
          - List of virtual machine (domain) configurations
          - Each entry contains arguments for community.libvirt.virt
          - WARNING - Most libvirt commands are not idempotent, use with caution
        type: list
        elements: dict
        required: false

      libvirt_networks:
        description:
          - List of virtual network configurations
          - Each entry contains arguments for community.libvirt.virt_net
          - WARNING - Most libvirt commands are not idempotent, use with caution
        type: list
        elements: dict
        required: false

      libvirt_pools:
        description:
          - List of storage pool configurations
          - Each entry contains arguments for community.libvirt.virt_pool
          - WARNING - Most libvirt commands are not idempotent, use with caution
        type: list
        elements: dict
        required: false

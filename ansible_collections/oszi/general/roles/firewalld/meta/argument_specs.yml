---
argument_specs:
  main:
    short_description: Firewalld firewall management
    description:
      - Manages firewalld configuration including zones, services, ports, and rules
      - Supports rich rules and direct iptables/nftables rules
      - Configures backend (nftables or iptables) and default zone
      - Automatically disabled for containers
    author:
      - "David O. (oszi.dev)"
    options:
      firewalld_disabled:
        description:
          - Whether to disable firewalld service
          - Automatically disabled for containers
        type: bool
        required: false
        default: "{{ ansible_facts.virtualization_type == 'container' }}"

      firewalld_default_zone:
        description:
          - Override the firewalld default zone
          - Upstream default is public, Fedora uses FedoraWorkstation or FedoraServer
        type: str
        required: false

      firewalld_services:
        description:
          - List of service names to accept besides SSH
          - Can be simple strings (service names) or dicts with zone and service keys
        type: list
        elements: raw
        required: false
        default: []

      firewalld_ports:
        description:
          - List of ports to accept besides SSH
          - Can be simple strings (port/protocol) or dicts with zone and port keys
        type: list
        elements: raw
        required: false
        default: []

      firewalld_rich_rules:
        description:
          - List of firewalld rich rules for complex firewall configurations
          - Can be simple strings (rules) or dicts with zone and rule keys
        type: list
        elements: raw
        required: false
        default: []

      firewalld_direct_rules:
        description:
          - List of firewalld direct rules using iptables/nftables syntax
          - Format is ipv4|ipv6|eb <table> <chain> <priority> <args>
        type: list
        elements: str
        required: false
        default: []

      firewalld_zones:
        description:
          - List of firewalld zone configurations
          - Each dict can contain interface, source, masquerade, and zone parameters
        type: list
        elements: dict
        required: false
        default: []
        options:
          interface:
            description: Network interface to bind to zone
            type: str
            required: false
          source:
            description: Source address/network to assign to zone
            type: str
            required: false
          masquerade:
            description: Whether to enable masquerading (NAT) for the zone
            type: bool
            required: false
          zone:
            description: Zone name to configure
            type: str
            required: false

      firewalld_permanent:
        description:
          - Whether firewall changes are permanent or runtime only
          - Set to false for temporary runtime changes using --extra-vars
        type: bool
        required: false
        default: true

      firewalld_backend:
        description:
          - Firewalld backend packet filter implementation
        type: str
        required: false
        default: "nftables"
        choices:
          - nftables
          - iptables

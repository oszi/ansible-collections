---
- name: Podman setup tasks
  tags: [podman]
  block:
    - name: Include podman setup tasks
      when: not podman_disabled
      ansible.builtin.include_tasks:
        file: podman.yml

    - name: Include podman-docker setup tasks
      when: not podman_disabled
      ansible.builtin.include_tasks:
        file: podman-docker.yml

    - name: Install podman quadlets
      when: not podman_disabled
      ansible.builtin.include_tasks:
        file: quadlet.yml
        apply:
          tags: [quadlet]
      loop: "{{ podman_quadlets | dict2items }}"
      loop_control:
        loop_var: quadlet_item
      tags: [quadlet]

    - name: Include podman disabled tasks
      when: podman_disabled
      ansible.builtin.include_tasks:
        file: podman-disabled.yml

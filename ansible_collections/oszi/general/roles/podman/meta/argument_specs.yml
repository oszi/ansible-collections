---
argument_specs:
  main:
    short_description: Podman container engine configuration and management
    description:
      - Manages Podman container engine installation and configuration
      - Installs podman-compose, podman-toolbox, and podman-docker emulation
      - Configures podman storage, policy, and runtime settings
      - Manages container networks, images, containers, and pods (consider podman_kube or podman_quadlets)
      - Supports rootless mode without system installation
    author:
      - "David O. (oszi.dev)"
    options:
      podman_disabled:
        description:
          - Whether to skip podman configuration, and uninstall podman packages when O(podman_install_system)
        type: bool
        required: false
        default: false

      podman_install_system:
        description:
          - Whether to install (or uninstall) podman and related system packages and files
          - Enabled when running as root, disable on immutable systems
        type: bool
        required: false

      podman_compose_enabled:
        description:
          - Whether to install podman-compose, a docker-compose alternative when O(podman_install_system)
        type: bool
        required: false

      podman_toolbox_enabled:
        description:
          - Whether to install toolbox from containertoolbx.org when O(podman_install_system)
          - Requires flatpak to not be disabled
        type: bool
        required: false

      podman_docker_enabled:
        description:
          - Whether to emulate docker using podman-docker when O(podman_install_system)
          - Provides docker CLI compatibility, conflicts with docker
        type: bool
        required: false

      podman_docker_compose_enabled:
        description:
          - Whether to install docker-compose when O(podman_install_system) (use with caution)
          - For rootless mode set DOCKER_HOST to unix://${XDG_RUNTIME_DIR}/podman/podman.sock
          - Prefer using a virtual environment instead of the distro package
        type: bool
        required: false
        default: false

      podman_graphroot:
        description:
          - Override the graphroot storage path from the default /var/lib/containers/storage
          - Specifies where container images and layers are stored
        type: path
        required: false

      podman_config_policy:
        description:
          - Contents of policy.json in YAML/JSON format
          - Defines container image signature verification and trust policies
          - Located at /etc/containers/policy.json or ~/.config/containers/policy.json
        type: dict
        required: false

      podman_config_containers:
        description:
          - Contents of containers.conf configuration file
          - Configures container runtime behavior, resource limits, and defaults
          - Located at /etc/containers/containers.conf or ~/.config/containers/containers.conf
          - See also /usr/share/containers/containers.conf
        type: str
        required: false

      podman_config_registries:
        description:
          - Contents of registries.conf configuration file
          - Configures registry resolution for relative image URLs
          - Located at /etc/containers/registries.conf or ~/.config/containers/registries.conf
        type: str
        required: false

      podman_config_mounts:
        description:
          - Contents of mounts.conf configuration file
          - Configures volume mounts that are automatically mounted inside containers
          - Located at /etc/containers/mounts.conf or ~/.config/containers/mounts.conf
          - See also /usr/share/containers/mounts.conf
        type: str
        required: false

      podman_config_toolbox:
        description:
          - Contents of toolbox.conf configuration file
          - Configures toolbox container defaults when O(podman_install_system)
          - Located at /etc/containers/toolbox.conf
        type: str
        required: false

      podman_local_bin_path:
        description:
          - Directory path where scripts for podman are installed
          - Defaults to `local_bin_path` if set (should be in system PATH),
            or ~/.local/bin (using ansible_facts.user_dir) in rootless mode
        type: path
        required: false

      podman_networks_list:
        description:
          - List of podman networks as arguments for M(containers.podman.podman_network)
          - Set recreate=true to force apply changes
          - Consider using .network quadlets instead
        type: list
        elements: dict
        required: false

      podman_images_list:
        description:
          - List of podman images as arguments for M(containers.podman.podman_image)
          - Consider using .image quadlets instead
        type: list
        elements: dict
        required: false

      podman_containers_list:
        description:
          - List of podman containers as arguments for M(containers.podman.podman_container)
          - Consider using .container quadlets instead
        type: list
        elements: dict
        required: false

      podman_pods_list:
        description:
          - List of podman pods as arguments for M(containers.podman.podman_pod)
          - Consider using .pod quadlets or podman-kube@.service instead
        type: list
        elements: dict
        required: false

  update:
    short_description: Update entrypoint for podman auto-update
    description:
      - Updates labelled podman containers and pods with podman auto-update
      - Containers and pods must set the `io.containers.autoupdate` label or Kubernetes annotation
      - Supports rootful and rootless execution
